#:kivy 2.3.0
#:import dp kivy.metrics.dp

<MDRoot@MDScreen>:
    md_bg_color: self.theme_cls.backgroundColor
    MDBoxLayout:
        orientation: "vertical"
        padding: dp(16)
        spacing: dp(16)

        MDLabel:
            text: "Тест диалога со списком (масштаб только при вертикальном лимите)"
            halign: "left"
            font_style: "Title"
            role: "large"

        MDBoxLayout:
            spacing: dp(12)
            adaptive_height: True

            MDButton:
                style: "filled"
                on_release: app.open_list_dialog(40)
                MDButtonText:
                    text: "Открыть список (40)"


MDRoot:

# ---------- Диалог со списком ----------
<AdaptiveListDialog>:
    elevation: 0
    radius: [dp(28)] * 4
    padding: dp(24)
    md_bg_color: self.theme_cls.surfaceContainerLowColor

    # ВИЗУАЛЬНОЕ СЖАТИЕ ВСЕГО ДИАЛОГА — origin по центру диалога
    canvas.before:
        PushMatrix
        Scale:
            x: root.render_scale
            y: root.render_scale
            origin: self.center
    canvas.after:
        PopMatrix

    MDAdaptiveDialogIcon:
        id: icon_c
        icon: "format-list-bulleted"

    MDAdaptiveDialogHeadlineText:
        id: headline_c
        text: "Выберите элементы"
        halign: "center"
        text_size: self.width, None
        adaptive_height: True

    MDAdaptiveDialogSupportingText:
        id: support_c
        text:
            "Список масштабируется вместе с диалогом и окном.\n" \
            "Контейнеры объявлены в KV, наполнение — в Python."
        halign: "center"
        text_size: self.width, None
        adaptive_height: True

    MDAdaptiveDialogContentContainer:
        id: content_c
        orientation: "vertical"
        size_hint_y: None
        height: dp(220)
        padding: 0
        spacing: 0

        MDScrollView:
            id: scroll
            do_scroll_x: False
            size_hint_y: None
            size_hint_x: 1.
            height: self.parent.height
            bar_width: dp(4)

            MDList:
                id: items_list
                size_hint_y: None
                size_hint_x: 1.
                height: self.minimum_height

    MDAdaptiveDialogButtonContainer:
        id: buttons_c
        size_hint_y: None
        height: dp(44)
        spacing: dp(8)

        Widget:
        ScaledMDButton:
            scale_provider: root
            style: "text"
            on_release: root.dismiss()
            MDButtonText:
                text: "Отмена"
        ScaledMDButton:
            scale_provider: root
            style: "filled"
            on_release: root.on_save()
            MDButtonText:
                text: "Сохранить"
